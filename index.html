<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimpleX - English</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { background-color: #0d1117; color: #c9d1d9; font-family: 'Inter', sans-serif; }
        .glass { background: #161b22; border: 1px solid #30363d; border-radius: 20px; }
        .tab-content { display: none; }
        .active { display: block; }
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
        .card-inner { transition: transform 0.6s; transform-style: preserve-3d; cursor: pointer; height: 200px; }
        .card-inner.flipped { transform: rotateY(180deg); }
        .card-face { backface-visibility: hidden; position: absolute; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; border-radius: 20px; padding: 20px; text-align: center; font-size: 1.5rem; font-weight: bold; }
        .card-back { transform: rotateY(180deg); background: #1f2937; color: #3b82f6; }
    </style>
</head>
<body>

    <div class="max-w-md mx-auto min-h-screen flex flex-col p-4">
        
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-black text-blue-500">SimpleX</h1>
            <div id="stats" class="text-right text-xs font-bold text-gray-500 uppercase">
                <span id="lvl">–£—Ä–æ–≤–µ–Ω—å 1</span> ‚Ä¢ <span id="xp">0 XP</span>
            </div>
        </div>

        <div class="flex-1">
            
            <section id="tab-cards" class="tab-content active">
                <h2 class="text-lg font-bold mb-4">–ö–∞—Ä—Ç–æ—á–∫–∏ —Å–ª–æ–≤</h2>
                <div class="perspective-1000">
                    <div id="flashcard" class="card-inner glass" onclick="this.classList.toggle('flipped')">
                        <div class="card-face">Experience</div>
                        <div class="card-face card-back">–û–ø—ã—Ç<br><span class="text-xs mt-2 text-gray-400">"I have much experience"</span></div>
                    </div>
                </div>
                <div class="flex gap-4 mt-6">
                    <button onclick="nextCard()" class="flex-1 py-4 glass hover:bg-gray-800 font-bold text-green-500">–ó–Ω–∞—é</button>
                    <button onclick="nextCard()" class="flex-1 py-4 glass hover:bg-gray-800 font-bold text-red-500">–ó–∞–±—ã–ª</button>
                </div>
            </section>

            <section id="tab-chat" class="tab-content">
                <div id="chat-win" class="h-[60vh] overflow-y-auto space-y-4 mb-4 text-sm p-2">
                    <div class="glass p-4 rounded-tl-none max-w-[85%]">
                        –ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π —É—á–∏—Ç–µ–ª—å SimpleX. –Ø –∑–Ω–∞—é, —á—Ç–æ —Ç—ã –≥–æ–≤–æ—Ä–∏—à—å –ø–æ-—Ä—É—Å—Å–∫–∏. –î–∞–≤–∞–π –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å –∞–Ω–≥–ª–∏–π—Å–∫–∏–π!
                    </div>
                </div>
                <div class="flex gap-2">
                    <input id="chat-in" type="text" placeholder="–ù–∞–ø–∏—à–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å..." class="flex-1 bg-gray-900 border border-gray-800 rounded-xl p-4 text-white outline-none focus:border-blue-500">
                    <button onclick="sendMsg()" class="bg-blue-600 px-6 rounded-xl font-bold">></button>
                </div>
            </section>

        </div>

        <nav class="mt-8 glass p-2 flex justify-around">
            <button onclick="switchTab('tab-cards')" class="p-4 text-xl">üé¥</button>
            <button onclick="switchTab('tab-chat')" class="p-4 text-xl">ü§ñ</button>
        </nav>
    </div>

    <script>
        let xp = parseInt(localStorage.getItem('sx_xp')) || 0;
        const token = "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";

        const words = [
            {en: "Challenge", ru: "–í—ã–∑–æ–≤ / –°–ª–æ–∂–Ω–æ—Å—Ç—å", ex: "It's a big challenge"},
            {en: "Opportunity", ru: "–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å", ex: "New opportunity for you"},
            {en: "Improve", ru: "–£–ª—É—á—à–∞—Ç—å", ex: "Improve your skills"}
        ];
        let wordIdx = 0;

        function updateStats() {
            document.getElementById('xp').innerText = `${xp} XP`;
            document.getElementById('lvl').innerText = `–£—Ä–æ–≤–µ–Ω—å ${Math.floor(xp/100) + 1}`;
            localStorage.setItem('sx_xp', xp);
        }

        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function nextCard() {
            wordIdx = (wordIdx + 1) % words.length;
            const card = document.getElementById('flashcard');
            card.classList.remove('flipped');
            setTimeout(() => {
                card.querySelector('.card-face:not(.card-back)').innerText = words[wordIdx].en;
                card.querySelector('.card-back').innerHTML = `${words[wordIdx].ru}<br><span class="text-xs mt-2 text-gray-400">"${words[wordIdx].ex}"</span>`;
                xp += 10;
                updateStats();
            }, 300);
        }

        async function sendMsg() {
            const input = document.getElementById('chat-in');
            const win = document.getElementById('chat-win');
            const val = input.value.trim();
            if(!val) return;

            win.innerHTML += `<div class="bg-blue-600 p-4 rounded-tr-none max-w-[85%] ml-auto text-white rounded-2xl">${val}</div>`;
            input.value = '';
            
            const tid = "t-" + Date.now();
            win.innerHTML += `<div id="${tid}" class="glass p-4 rounded-tl-none max-w-[85%] italic text-gray-500">–î—É–º–∞—é...</div>`;
            win.scrollTop = win.scrollHeight;

            try {
                const res = await fetch("https://api-inference.huggingface.co/models/meta-llama/Meta-Llama-3-8B-Instruct", {
                    headers: { Authorization: `Bearer ${token}` },
                    method: "POST",
                    body: JSON.stringify({ 
                        inputs: `<|begin_of_text|><|start_header_id|>system<|end_header_id|>You are a friendly English teacher for a Russian student. Answer in English, but you can explain in Russian if the student is confused.<|eot_id|><|start_header_id|>user<|end_header_id|>${val}<|eot_id|><|start_header_id|>assistant<|end_header_id|>`,
                        parameters: { max_new_tokens: 100 }
                    }),
                });
                const data = await res.json();
                document.getElementById(tid).remove();
                
                let reply = data[0].generated_text.split('assistant').pop().trim();
                win.innerHTML += `<div class="glass p-4 rounded-tl-none max-w-[85%] border-l-4 border-blue-500">${reply}</div>`;
                xp += 20;
                updateStats();
            } catch(e) {
                document.getElementById(tid).innerText = "–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏. –ü—Ä–æ–≤–µ—Ä—å —Ç–æ–∫–µ–Ω –Ω–∞ Hugging Face!";
            }
            win.scrollTop = win.scrollHeight;
        }

        updateStats();
    </script>
</body>
</html>
